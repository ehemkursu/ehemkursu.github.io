<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Sayı Yakalama Oyunu - ehemkursu</title>
    <style>
        body {
            margin: 0; padding: 0; overflow: hidden;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: #0f172a; color: white; user-select: none;
            touch-action: none;
        }

        /* Üst Panel */
        #ui-panel {
            position: absolute; top: 20px; left: 20px;
            background: rgba(30, 41, 59, 0.9); padding: 15px 25px;
            border-radius: 12px; border: 1px solid #475569; z-index: 1000;
            min-width: 150px;
        }

        /* Görev Mesajı (Yeni eklendi) */
        #mission-text {
            margin-top: 10px;
            padding: 5px;
            background: rgba(234, 179, 8, 0.15);
            color: #fbbf24;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
            border-radius: 5px;
            border: 1px solid rgba(234, 179, 8, 0.3);
        }

        /* ehemkursu Yazısı */
        #brand {
            position: absolute; top: 20px; right: 20px;
            color: #eab308; font-size: 24px; font-weight: bold;
            letter-spacing: 1px; text-transform: lowercase;
            text-shadow: 0 0 10px rgba(234, 179, 8, 0.5);
            z-index: 2000;
        }

        #drop-zones {
            display: none; position: absolute; right: 40px; top: 50%;
            transform: translateY(-50%); width: 200px; flex-direction: column; gap: 20px;
        }

        .drop-box {
            width: 100%; height: 120px; border-radius: 15px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; border: 4px dashed rgba(255,255,255,0.2);
            background: rgba(255, 255, 255, 0.05);
        }

        .number-circle {
            width: 65px; height: 65px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            position: absolute; font-size: 20pt; font-weight: bold;
            cursor: pointer; box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            z-index: 500;
        }

        .positive { background: #10b981; border: 2px solid white; }
        .negative { background: #ef4444; border: 2px solid white; }
        .clicked-state { background: #eab308 !important; color: black; transform: scale(1.3); }

        #overlay {
            display: none; position: fixed; inset: 0;
            background: rgba(0,0,0,0.95); flex-direction: column;
            align-items: center; justify-content: center; z-index: 3000;
            text-align: center;
        }

        .btn-next {
            padding: 15px 40px; font-size: 18px; background: #eab308;
            border: none; border-radius: 50px; cursor: pointer;
            font-weight: bold; color: black; margin-top: 20px;
        }

        #l5-status { display: none; margin-top: 10px; font-size: 14px; border-top: 1px solid #475569; padding-top: 5px; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="brand">ehemkursu</div>

<div id="ui-panel">
    <div>SKOR: <span id="score" style="color:#eab308; font-size: 24px;">0</span></div>
    <div style="font-size: 14px; margin-top:5px; color:#94a3b8;">TUR: <span id="level">1</span></div>
    <div id="mission-text">yeşil sol tuş</div> <div id="l5-status">
        <div style="color:#10b981">SOL (Yeşil): <span id="l-score">0</span>/100</div>
        <div style="color:#f87171">SAĞ (Kırmızı): <span id="r-score">0</span>/100</div>
    </div>
</div>

<div id="drop-zones">
    <div class="drop-box" id="box-pos" style="border-color: #10b981; color: #10b981;">YEŞİL (+)<br><span id="sum-pos" style="font-size:24px; color:white;">0</span>/100</div>
    <div class="drop-box" id="box-neg" style="border-color: #ef4444; color: #ef4444;">KIRMIZI (-)<br><span id="sum-neg" style="font-size:24px; color:white;">0</span>/100</div>
</div>

<div id="overlay">
    <h1 id="otitle" style="color: #eab308; font-size: 48px;">TUR BİTTİ!</h1>
    <p id="odesc" style="font-size: 20px; margin: 20px; max-width: 600px;"></p>
    <button class="btn-next" id="cont-btn" onclick="closeOverlay()">DEVAM ET</button>
</div>

<div id="game-container" style="width: 100vw; height: 100vh; position: relative;"></div>

<script>
    const container = document.getElementById('game-container');
    const scoreText = document.getElementById('score');
    const levelText = document.getElementById('level');
    const missionText = document.getElementById('mission-text');
    const overlay = document.getElementById('overlay');
    
    let score = 0, currentLevel = 1, isRunning = true;
    let pSum = 0, nSum = 0; 
    let lScore = 0, rScore = 0; 
    let settings = { max: 5, time: 3000, speed: 2 };

    const levelMissions = {
        1: "yeşil sol tuş",
        2: "yeşil sol tuş",
        3: "kutuya sürükle",
        4: "yeşile çift tıklat",
        5: "sağ tık - sol tık"
    };

    function createItem() {
        if (!isRunning) return;
        const el = document.createElement('div');
        const val = Math.floor(Math.random() * 9) + 1;
        const isNeg = Math.random() < 0.5;

        el.className = `number-circle ${isNeg ? 'negative' : 'positive'}`;
        el.textContent = isNeg ? `-${val}` : val;
        el.dataset.val = val; el.dataset.isNeg = isNeg;

        let x = Math.random() * (window.innerWidth - 100), y = Math.random() * (window.innerHeight - 100);
        let dx = (Math.random() - 0.5) * settings.speed, dy = (Math.random() - 0.5) * settings.speed;
        el.style.left = x + 'px'; el.style.top = y + 'px';

        if (currentLevel < 3) {
            el.onpointerdown = () => { updateScore(isNeg ? -val : val); el.remove(); };
        } else if (currentLevel === 3) {
            handleDrag(el, isNeg, val);
        } else if (currentLevel === 4) {
            el.ondblclick = () => {
                el.classList.add('clicked-state');
                setTimeout(() => { updateScore(isNeg ? -val : val); el.remove(); }, 150);
            };
        } else if (currentLevel === 5) {
            el.onmousedown = (e) => {
                if (e.button === 0 && !isNeg) { lScore += val; el.remove(); } 
                else if (e.button === 2 && isNeg) { rScore += val; el.remove(); }
                else {
                    if (e.button === 0) lScore -= 5; else rScore -= 5;
                    el.style.boxShadow = "0 0 30px white";
                }
                document.getElementById('l-score').textContent = lScore;
                document.getElementById('r-score').textContent = rScore;
                if (lScore >= 100 && rScore >= 100) nextLevelTrigger();
            };
        }

        const move = () => {
            if (!el.parentElement || el.dataset.drag === "true") return;
            x += dx; y += dy;
            if (x < 0 || x > window.innerWidth - 80) dx *= -1;
            if (y < 0 || y > window.innerHeight - 80) dy *= -1;
            el.style.left = x + 'px'; el.style.top = y + 'px';
            requestAnimationFrame(move);
        };
        requestAnimationFrame(move);
        container.appendChild(el);
        let life = (currentLevel === 4 && !isNeg) ? 6000 : (currentLevel === 4 ? 4000 : settings.time);
        setTimeout(() => { if (el.parentElement && el.dataset.drag !== "true") el.remove(); }, life);
    }

    function handleDrag(el, isNeg, val) {
        el.onpointerdown = (e) => {
            el.dataset.drag = "true"; el.setPointerCapture(e.pointerId);
            let ox = e.clientX - el.offsetLeft, oy = e.clientY - el.offsetTop;
            el.onpointermove = (ev) => { el.style.left = (ev.clientX - ox) + 'px'; el.style.top = (ev.clientY - oy) + 'px'; };
            el.onpointerup = (ev) => {
                el.onpointermove = null; el.dataset.drag = "false";
                const bP = document.getElementById('box-pos').getBoundingClientRect(), bN = document.getElementById('box-neg').getBoundingClientRect();
                const hit = (r) => ev.clientX > r.left && ev.clientX < r.right && ev.clientY > r.top && ev.clientY < r.bottom;
                if (hit(bP) && !isNeg) { pSum += val; document.getElementById('sum-pos').textContent = pSum; el.remove(); }
                else if (hit(bN) && isNeg) { nSum += val; document.getElementById('sum-neg').textContent = nSum; el.remove(); }
                if (pSum >= 100 && nSum >= 100) nextLevelTrigger();
            };
        };
    }

    function updateScore(n) {
        score += n; scoreText.textContent = score;
        if ((currentLevel === 1 && score >= 100) || (currentLevel === 2 && score >= 200) || (currentLevel === 4 && score >= 200)) nextLevelTrigger();
    }

    function nextLevelTrigger() {
        isRunning = false; container.innerHTML = "";
        let d = "";
        if (currentLevel === 1) d = "Tur 2 başlıyor! Sayılar hızlanıyor.";
        else if (currentLevel === 2) d = "Tur 3: Sayıları doğru kutulara sürükleyin!";
        else if (currentLevel === 3) d = "Tur 4: Çift Tıklama (Double Click) zamanı!";
        else if (currentLevel === 4) d = "Tur 5: FİNAL! Yeşil=Sol Tık, Kırmızı=Sağ Tık.";
        else { d = "Tebrikler! Oyunu başarıyla tamamladınız."; document.getElementById('otitle').textContent = "OYUN BİTTİ"; document.getElementById('cont-btn').textContent = "Yeniden Başla"; }
        document.getElementById('odesc').textContent = d;
        overlay.style.display = "flex";
    }

    function closeOverlay() {
        overlay.style.display = "none";
        if (currentLevel === 5) { location.reload(); return; }
        currentLevel++; 
        levelText.textContent = currentLevel;
        missionText.textContent = levelMissions[currentLevel]; // Mesajı güncelle
        
        document.getElementById('drop-zones').style.display = (currentLevel === 3) ? 'flex' : 'none';
        document.getElementById('l5-status').style.display = (currentLevel === 5) ? 'block' : 'none';
        
        if (currentLevel === 2) settings = { max: 8, time: 2500, speed: 4 };
        if (currentLevel === 3) settings = { max: 6, time: 7000, speed: 1.5 };
        if (currentLevel === 4) { settings = { max: 6, time: 4000, speed: 1.2 }; score = 0; scoreText.textContent = "0"; }
        if (currentLevel === 5) { settings = { max: 7, time: 4000, speed: 2 }; score = 0; scoreText.textContent = "0"; }
        isRunning = true;
    }

    setInterval(() => { if (isRunning && document.querySelectorAll('.number-circle').length < settings.max) createItem(); }, 600);
    createItem();
</script>
</body>
</html>